@page "/"
@using YachtLogHoursCalculator.Calculator

<PageTitle>Kalkulator godzin dla dziennika jachtowego</PageTitle>

<MudContainer Style="width: 100%; height: 100%">
    <MudGrid>
        <MudItem xs=12>
            <LogItems entries="@entries" entriesChanged="@EntriesChanged"/>
        </MudItem>
        <MudItem xs=12>
            <LogItemAdd entries="@entries" entriesChanged="@EntriesChanged"/>
        </MudItem>
        <MudItem xs=12>
            <LogSummary PreviousDay=@previousDay Entries="@entries"/>
        </MudItem>
        <MudItem xs=12>
            <MudSpacer/>
            <MudButton Class="object-right" OnClick="() => NextDay()" Color="Color.Primary" Variant="Variant.Filled">
                Następny dzień
            </MudButton>
        </MudItem>
    </MudGrid>

</MudContainer>



@code {
    LogEntrySet previousDay { get; set; } = LogEntrySet.Empty;

    List<LogEntry> entries { get; set; } = new();

    public void NextDay()
    {
        if (entries.Any())
        {
            var typeNextDayStartsWith = entries.Last().Type;
            previousDay = LogEntrySet.FromEntries(entries, previousDay);
            entries.Clear();
            entries.Add(new LogEntry(TimeSpan.Zero, typeNextDayStartsWith));
        }
    }

    public void EntriesChanged(List<LogEntry> entries)
    {
        StateHasChanged();
    }
}